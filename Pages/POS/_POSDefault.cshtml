@model WebPOS.Models.Business  
@{  
    var categories = ViewData["Categories"] as List<WebPOS.Models.Category> ?? new List<WebPOS.Models.Category>();  
    var products = ViewData["Products"] as List<WebPOS.Models.Product> ?? new List<WebPOS.Models.Product>();  
    var selectedCategoryId = ViewData["SelectedCategoryId"] as int?;  
    var cart = ViewData["Cart"] as List<WebPOS.Models.CartItem> ?? new List<WebPOS.Models.CartItem>();  
}  

<div class="container-fluid my-4">  
    <div class="row">  
        <!-- Main POS area (products/categories) -->  
        <div class="col-md-8">  
            <h2 class="mb-3">Select Category</h2>  
            <div class="btn-group mb-4" role="group" aria-label="Categories">  
                <a href="/POS" class="btn btn-outline-primary @(selectedCategoryId == null ? "active" : "")">All</a>  
                @foreach (var category in categories)  
                {  
                    <a href="/POS?categoryId=@category.CategoryId"  
                       class="btn btn-outline-primary @(selectedCategoryId == category.CategoryId ? "active" : "")">  
                        @category.Name  
                    </a>  
                }  
            </div>  

            <h2 class="mb-3">Products</h2>  
            <div class="row row-cols-2 row-cols-md-3 g-4">  
                @foreach (var product in products)  
                {  
                    <div class="col">  
                        <div class="card h-100 shadow-sm">  
                            <div class="card-body d-flex flex-column align-items-center">  
                                <h5 class="card-title">@product.Name</h5>  
                                <p class="card-text">@product.Price.ToString("C")</p>  
                                <form asp-page-handler="AddToCart" method="post">  
                                    <input type="hidden" name="productId" value="@product.ProductId" />  
                                    <input type="hidden" name="categoryId" value="@selectedCategoryId" />  
                                    <button type="submit" class="btn btn-success mt-auto">Add</button>  
                                </form>  
                            </div>  
                        </div>  
                    </div>  
                }  
            </div>  
        </div>  

        <!-- Cart sidebar -->  
        <div class="col-md-4">  
            <div class="card shadow">  
                <div class="card-header bg-primary text-white">  
                    <h4 class="mb-0">Cart</h4>  
                </div>  
                <div class="card-body">  
                    @if (cart != null && cart.Any())  
                    {  
                        <table class="table table-sm">  
                            <thead>  
                                <tr>  
                                    <th>Product</th>  
                                    <th>Qty</th>  
                                    <th>Price</th>  
                                    <th>Subtotal</th>  
                                </tr>  
                            </thead>  
                            <tbody>  
                                @foreach (var item in cart)  
                                {  
                                    <tr>  
                                        <td>@item.ProductName</td>  
                                        <td>@item.Quantity</td>  
                                        <td>@item.Price.ToString("C")</td>  
                                        <td>@item.Subtotal.ToString("C")</td>  
                                    </tr>  
                                }  
                            </tbody>  
                        </table>  
                        <div class="text-end fw-bold mt-3">  
                            Total: @cart.Sum(i => i.Subtotal).ToString("C")  
                        </div>  
                    }  
                    else  
                    {  
                        <div class="text-muted text-center">Cart is empty.</div>  
                    }  
                </div>  
            </div>  
        </div>  
    </div>  
</div>
